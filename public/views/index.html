<section data-ng-controller="IndexController">
	<h1>Sharptung</h1>
	<br />
    <label class="col-md-5 control-label">Translate</label>
    <div class="col-md-8">
        <input id="translate" class="form-control" type="text" name="translate" placeholder="" autofocus></input>
    </div>
    <div class="col-md-8">
        <select id="language-list"></select>
        <script>
            var sel = document.getElementById('language-list');
            var req = new XMLHttpRequest();
            
            req.open('GET', 'googletranslate.txt', false);
            req.send();
            req.onreadystatechange = function() {
                if (req.readyState == 4 && req.status==200) {
                    var text = req.response;
                    text = text.split('\n');
                    
                    for (var i = 0; i < text.length; i++) {
                        var opt = document.createElement('option');
                        var langValuePair = text[i].split(" ");
                        opt.innerHTML = langValuePair[0];
                        opt.value = langValuePair[1];
                        //opt.innerHTML = languages[i].substr(0,languages[i].lastIndexOf(' '));
                        //opt.value = languages[i].substr(languages[i].indexof(' '),languages[i].length);
                        sel.appendChild(opt);
                    }
                }
            };
        </script>
    </div>
    <div class="col-md-offset-4 col-md-8">
        <button id="submitButton" class="btn btn-primary">Submit</button>
    </div>
    <div id="output"></div>

	<script>
	document.getElementById("submitButton").addEventListener('click', doTranslation, false);
	function doTranslation() {
	  console.log('clicked');
    	var myTranslate = document.getElementById("translate").value;
        if (myTranslate !== null) {
          $http({
            url: 'translate/quick/to/es',
              method : 'GET'
            }).success(function(data) {
              if (data) {
                var speech = new Audio(data.tts);
                speech.play();
                document.getElementById('output').innerText = data;
                console.log(data);
              }
          });
      }
    }
    
    function selectLanguage(event) {
        var toTranslate = document.getElementById("translate").value;
        var toLanguage = document.getElementById('language-list').value;
        
    }
    document.getElementById('language-list').addEventListener('change', selectLanguage, false);
	</script>
</section>